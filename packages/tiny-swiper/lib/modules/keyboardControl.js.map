{"version":3,"file":"keyboardControl.js","sources":["../../src/core/render/dom.ts","../../src/modules/keyboardControl.ts"],"sourcesContent":["export function addClass (\n    el: HTMLElement,\n    list: Array<string> | string = []\n): void {\n    if (!Array.isArray(list)) list = [list]\n\n    list.forEach(clz => (!el.classList.contains(clz) && el.classList.add(clz)))\n}\n\nexport function removeClass (\n    el: HTMLElement,\n    list: Array<string> | string = []\n): void {\n    if (!Array.isArray(list)) list = [list]\n\n    list.forEach(clz => (el.classList.contains(clz) && el.classList.remove(clz)))\n}\n\nexport function attachListener (\n    el: HTMLElement | Document | Window,\n    evtName: string,\n    handler: EventListenerOrEventListenerObject,\n    opts?: boolean | AddEventListenerOptions\n): void {\n    el.addEventListener(evtName, handler, opts)\n}\n\nexport function detachListener (\n    el: HTMLElement | Document | Window,\n    evtName: string,\n    handler: EventListenerOrEventListenerObject\n): void {\n    el.removeEventListener(evtName, handler)\n}\n\nexport function removeAttr (\n    el: HTMLElement,\n    attr: string\n): void {\n    el.removeAttribute(attr)\n}\n\nexport function setAttr (\n    el: HTMLElement,\n    attr: string,\n    value = ''\n): HTMLElement {\n    el.setAttribute(attr, value)\n    return el\n}\n\nexport function setStyle (\n    el: HTMLElement,\n    style: {[key: string]: string},\n    forceRender?: boolean\n): HTMLElement {\n    Object.keys(style).forEach(prop => {\n        // TS7015: Element implicitly has an 'any' type because index expression is not of type 'number'.\n        el.style[prop as any] = style[prop]\n    })\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    forceRender && getComputedStyle(el)\n\n    return el\n}\n\nexport function getTranslate (\n    el: HTMLElement,\n    isHorizontal: boolean\n): number {\n    const matrix = getComputedStyle(el).transform.replace(/[a-z]|\\(|\\)|\\s/g, '').split(',').map(parseFloat)\n    let arr: Array<number> = []\n\n    if (matrix.length === 16) {\n        arr = matrix.slice(12, 14)\n    } else if (matrix.length === 6) {\n        arr = matrix.slice(4, 6)\n    }\n    return (<Array<number>>arr)[isHorizontal ? 0 : 1] || 0\n}\n","import {\n    attachListener,\n    detachListener\n} from '../core/render/dom'\nimport { SwiperInstance } from '../core/index'\nimport { Options } from '../core/options'\n\nexport type SwiperPluginKeyboardControlOptions = {\n    enabled: boolean\n    onlyInViewport: boolean\n}\n\nconst DIRECTION = {\n    up: 'ArrowUp',\n    right: 'ArrowRight',\n    down: 'ArrowDown',\n    left: 'ArrowLeft'\n}\n\nfunction isVisible (el: HTMLElement): boolean {\n    if (!el) return false\n\n    const style = getComputedStyle(el)\n    const visible = style.visibility !== 'hidden' && style.display !== 'none'\n\n    if (!visible) return false\n\n    return el.parentElement && el.parentElement.nodeType === 1\n        ? isVisible(el.parentElement)\n        : true\n}\n\nfunction isElementInView (el: HTMLElement): boolean {\n    const visibility = isVisible(el)\n    const boundary = el.getBoundingClientRect()\n    const isInView = (boundary.top >= 0 && boundary.bottom <= window.innerHeight)\n        && (boundary.left >= 0 && boundary.right <= window.innerWidth)\n\n    return isInView && visibility\n}\n\n/**\n * TinySwiper plugin for keyboard control.\n *\n * @param {SwiperInstance} instance\n * @param {Options}\n */\nexport default function SwiperPluginKeyboardControl (\n    instance: SwiperInstance & {\n        keyboard: {\n            onKeyDown (e: Event): void\n            enable (): void\n            disable (): void\n        }\n    },\n    options: Options\n): void {\n    if (!options.keyboard) return\n\n    const keyboardOptions = <SwiperPluginKeyboardControlOptions>options.keyboard\n    const keyboard = {\n        enable (): void {\n            keyboardOptions.enabled = true\n        },\n        disable (): void {\n            keyboardOptions.enabled = false\n        },\n        onKeyDown (e: KeyboardEvent): void {\n            const { key } = e\n\n            if ((keyboardOptions.onlyInViewport && !isElementInView(instance.env.element.$el))\n                || !keyboardOptions.enabled) return\n\n            if (options.isHorizontal) {\n                if (key === DIRECTION.left) {\n                    instance.slideTo(instance.state.index - 1)\n                } else if (key === DIRECTION.right) {\n                    instance.slideTo(instance.state.index + 1)\n                }\n            } else {\n                if (key === DIRECTION.down) {\n                    instance.slideTo(instance.state.index - 1)\n                } else if (key === DIRECTION.up) {\n                    instance.slideTo(instance.state.index + 1)\n                }\n            }\n        }\n    }\n\n    instance.on('before-init', () => {\n        options.keyboard = {\n            enabled: true,\n            onlyInViewport: true,\n            ...options.keyboard\n        }\n\n        instance.keyboard = keyboard\n\n        attachListener(window, 'keydown', keyboard.onKeyDown as EventListener)\n    })\n\n    instance.on('after-destroy', () => {\n        if (!keyboard) return\n\n        detachListener(window, 'keydown', keyboard.onKeyDown as EventListener)\n\n        delete instance.keyboard\n    })\n}\n"],"names":["attachListener","el","evtName","handler","opts","addEventListener","detachListener","removeEventListener","DIRECTION","up","right","down","left","isVisible","style","getComputedStyle","visible","visibility","display","parentElement","nodeType","isElementInView","boundary","getBoundingClientRect","isInView","top","bottom","window","innerHeight","innerWidth","SwiperPluginKeyboardControl","instance","options","keyboard","keyboardOptions","enable","enabled","disable","onKeyDown","e","key","onlyInViewport","env","element","$el","isHorizontal","slideTo","state","index","on"],"mappings":"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"}