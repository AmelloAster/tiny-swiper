{"version":3,"file":"index.js","sources":["../src/core/render/dom.ts","../src/core/render/layout.ts","../src/core/options.ts","../src/core/eventHub.ts","../src/core/state/trace.ts","../src/core/state/index.ts","../src/core/render/nextTick.ts","../src/core/render/animation.ts","../src/core/sensor/actions.ts","../src/core/sensor/index.ts","../src/core/env/measure.ts","../src/core/env/limitation.ts","../src/core/env/index.ts","../src/core/render/index.ts","../src/core/state/operations.ts","../src/core/env/element.ts","../src/core/index.ts"],"sourcesContent":["export function addClass (\r\n    el: HTMLElement,\r\n    list: Array<string> | string = []\r\n): void {\r\n    if (!Array.isArray(list)) list = [list]\r\n\r\n    list.forEach(clz => (!el.classList.contains(clz) && el.classList.add(clz)))\r\n}\r\n\r\nexport function removeClass (\r\n    el: HTMLElement,\r\n    list: Array<string> | string = []\r\n): void {\r\n    if (!Array.isArray(list)) list = [list]\r\n\r\n    list.forEach(clz => (el.classList.contains(clz) && el.classList.remove(clz)))\r\n}\r\n\r\nexport function attachListener (\r\n    el: HTMLElement | Document | Window,\r\n    evtName: string,\r\n    handler: EventListenerOrEventListenerObject,\r\n    opts?: boolean | AddEventListenerOptions\r\n): void {\r\n    el.addEventListener(evtName, handler, opts)\r\n}\r\n\r\nexport function detachListener (\r\n    el: HTMLElement | Document | Window,\r\n    evtName: string,\r\n    handler: EventListenerOrEventListenerObject\r\n): void {\r\n    el.removeEventListener(evtName, handler)\r\n}\r\n\r\nexport function removeAttr (\r\n    el: HTMLElement,\r\n    attr: string\r\n): void {\r\n    el.removeAttribute(attr)\r\n}\r\n\r\nexport function setAttr (\r\n    el: HTMLElement,\r\n    attr: string,\r\n    value = ''\r\n): HTMLElement {\r\n    el.setAttribute(attr, value)\r\n    return el\r\n}\r\n\r\nexport function setStyle (\r\n    el: HTMLElement,\r\n    style: {[key: string]: string},\r\n    forceRender?: boolean\r\n): HTMLElement {\r\n    Object.keys(style).forEach(prop => {\r\n        // TS7015: Element implicitly has an 'any' type because index expression is not of type 'number'.\r\n        el.style[prop as any] = style[prop]\r\n    })\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\r\n    forceRender && getComputedStyle(el)\r\n\r\n    return el\r\n}\r\n\r\nexport function getTranslate (\r\n    el: HTMLElement,\r\n    isHorizontal: boolean\r\n): number {\r\n    const matrix = getComputedStyle(el).transform.replace(/[a-z]|\\(|\\)|\\s/g, '').split(',').map(parseFloat)\r\n    let arr: Array<number> = []\r\n\r\n    if (matrix.length === 16) {\r\n        arr = matrix.slice(12, 14)\r\n    } else if (matrix.length === 6) {\r\n        arr = matrix.slice(4, 6)\r\n    }\r\n    return (<Array<number>>arr)[isHorizontal ? 0 : 1] || 0\r\n}\r\n","import { State } from '../state/index'\r\nimport { Env } from '../env/index'\r\nimport { setStyle } from './dom'\r\nimport { Options } from '../options'\r\n\r\nexport function translate (\r\n    state: State,\r\n    env: Env,\r\n    options: Options,\r\n    duration: number\r\n): void {\r\n    const {\r\n        $wrapper\r\n    } = env.element\r\n    const wrapperStyle = {\r\n        transition: state.isStart\r\n            ? 'none'\r\n            : `transform ease ${duration}ms`,\r\n        transform: options.isHorizontal\r\n            ? `translate3d(${state.transforms}px, 0, 0)`\r\n            : `translate3d(0, ${state.transforms}px, 0)`\r\n    }\r\n\r\n    setStyle($wrapper, wrapperStyle)\r\n}\r\n","import { SwiperPlugin } from './index'\r\nimport { translate } from './render/layout'\r\nimport { State } from './state/index'\r\nimport { Env } from './env/index'\r\nimport { SwiperPluginLazyloadOptions } from '../modules/lazyload'\r\nimport { SwiperPluginPaginationOptions } from '../modules/pagination'\r\nimport { SwiperPluginKeyboardControlOptions } from '../modules/keyboardControl'\r\n\r\nexport type Direction = 'horizontal' | 'vertical'\r\nexport type Injections = {\r\n    translate: (\r\n        state: State,\r\n        env: Env,\r\n        options: Options,\r\n        duration: number\r\n    ) => void\r\n}\r\n\r\nexport type Options = {\r\n    direction: Direction\r\n    touchRatio: number\r\n    touchAngle: number\r\n    longSwipesRatio: number\r\n    initialSlide: number\r\n    loop: boolean\r\n    freeMode: boolean\r\n    mousewheel: boolean\r\n    passiveListeners: boolean\r\n    resistance: boolean\r\n    resistanceRatio: number\r\n    speed: number\r\n    longSwipesMs: number\r\n    spaceBetween: number\r\n    slidesPerView: number\r\n    centeredSlides: boolean\r\n    slidePrevClass: string\r\n    slideNextClass: string\r\n    slideActiveClass: string\r\n    slideClass: string\r\n    wrapperClass: string\r\n    touchStartPreventDefault: boolean\r\n    touchStartForcePreventDefault: boolean\r\n    touchMoveStopPropagation: boolean\r\n    excludeElements: Array<HTMLElement>\r\n    isHorizontal: boolean\r\n    plugins?: Array<SwiperPlugin>\r\n    injections: Injections\r\n\r\n    // Plugins\r\n    lazyload?: SwiperPluginLazyloadOptions\r\n    keyboard?: SwiperPluginKeyboardControlOptions\r\n    pagination?: SwiperPluginPaginationOptions\r\n}\r\n\r\nexport type UserOptions = Partial<Options>\r\n\r\nconst defaultOptions: UserOptions = {\r\n    // `isHorizontal` is computed value\r\n    direction: 'horizontal',\r\n    touchRatio: 1,\r\n    touchAngle: 45,\r\n    longSwipesRatio: 0.5,\r\n    initialSlide: 0,\r\n    loop: false,\r\n    freeMode: false,\r\n    mousewheel: false,\r\n    passiveListeners: true,\r\n    resistance: true,\r\n    resistanceRatio: 0.85,\r\n    speed: 300,\r\n    longSwipesMs: 300,\r\n    spaceBetween: 0,\r\n    slidesPerView: 1,\r\n    centeredSlides: false,\r\n    slidePrevClass: 'swiper-slide-prev',\r\n    slideNextClass: 'swiper-slide-next',\r\n    slideActiveClass: 'swiper-slide-active',\r\n    slideClass: 'swiper-slide',\r\n    wrapperClass: 'swiper-wrapper',\r\n    touchStartPreventDefault: true,\r\n    touchStartForcePreventDefault: false,\r\n    touchMoveStopPropagation: false,\r\n    excludeElements: [],\r\n    injections: {\r\n        translate\r\n    }\r\n}\r\n\r\nexport function optionFormatter (userOptions?: UserOptions): Options {\r\n    const options = <Options>{\r\n        ...defaultOptions,\r\n        ...userOptions\r\n    }\r\n\r\n    return {\r\n        ...options,\r\n        isHorizontal: options.direction === 'horizontal'\r\n    }\r\n}\r\n","export type EventHub = {\r\n    // eslint-disable-next-line @typescript-eslint/ban-types\r\n    on (evtName: string, cb: Function): void\r\n    off (evtName: string, cb: Function): void\r\n    emit (evtName: string, ...data: Array<any>): void\r\n    clear (): void\r\n}\r\n\r\nexport const LIFE_CYCLES = {\r\n    BEFORE_INIT: 'before-init',\r\n    AFTER_INIT: 'after-init',\r\n    BEFORE_SLIDE: 'before-slide',\r\n    SCROLL: 'scroll',\r\n    AFTER_SLIDE: 'after-slide',\r\n    BEFORE_DESTROY: 'before-destroy',\r\n    AFTER_DESTROY: 'after-destroy'\r\n}\r\n\r\nexport function EventHub (): EventHub {\r\n    let hub: {\r\n        [key: string]: Array<Function>\r\n    } = {}\r\n\r\n    function on (evtName: string, cb: Function): void {\r\n        if (!hub[evtName]) {\r\n            hub[evtName] = [cb]\r\n        } else {\r\n            hub[evtName].push(cb)\r\n        }\r\n    }\r\n\r\n    function off (evtName: string, cb: Function): void {\r\n        if (hub[evtName]) {\r\n            const index = hub[evtName].indexOf(cb)\r\n\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-expressions\r\n            index > -1 && hub[evtName].splice(index, 1)\r\n        }\r\n    }\r\n\r\n    function emit (evtName: string, ...data: Array<any>): void {\r\n        if (hub[evtName]) {\r\n            hub[evtName].forEach(cb => cb(...data))\r\n        }\r\n    }\r\n\r\n    function clear (): void {\r\n        hub = {}\r\n    }\r\n\r\n    return {\r\n        on,\r\n        off,\r\n        emit,\r\n        clear\r\n    }\r\n}\r\n","const delta = 180 / Math.PI\r\n\r\nexport type TraceLogs = Array<Trace>\r\n\r\nexport type Offset = {\r\n    /**\r\n     * offset x\r\n     */\r\n    x: number\r\n\r\n    /**\r\n     * offset y\r\n     */\r\n    y: number\r\n}\r\n\r\nexport type Position = {\r\n    /**\r\n     * postion in the x-axis\r\n     */\r\n    x: number\r\n\r\n    /**\r\n     * postion in the y-axis\r\n     */\r\n    y: number\r\n}\r\n\r\nexport type Trace = {\r\n    /**\r\n     * timestamp of current postion\r\n     */\r\n    time: number\r\n} & Position\r\n\r\nexport type Tracker = {\r\n    push (postion: Position): void\r\n    vector (): Vector\r\n    clear (): void\r\n    getLogs (): TraceLogs\r\n    getDuration (): number\r\n    getOffset (): Offset\r\n}\r\n\r\nexport type Vector = {\r\n    /**\r\n     * offset in the x-axis\r\n     */\r\n    x: number\r\n\r\n    /**\r\n     * offset in the y-axis\r\n     */\r\n    y: number\r\n\r\n    /**\r\n     * velocity in the x-axis\r\n     */\r\n    velocityX: number\r\n\r\n    /**\r\n     * velocity in the y-axis\r\n     */\r\n    velocityY: number\r\n\r\n    /**\r\n     * direction angle\r\n     */\r\n    angle: number\r\n}\r\n\r\nexport function Vector (\r\n    logs: TraceLogs,\r\n    index: number\r\n): Vector {\r\n    const trace = logs[index]\r\n    const formerTrace = logs[index - 1] || trace // In case click action, there will be only one log data\r\n    const diff = {\r\n        x: trace.x - formerTrace.x,\r\n        y: trace.y - formerTrace.y\r\n    }\r\n    const duration = trace.time - formerTrace.time\r\n    const velocityX = diff.x / duration || 0\r\n    const velocityY = diff.y / duration || 0\r\n    const angle = Math.atan2(Math.abs(diff.y), Math.abs(diff.x)) * delta\r\n\r\n    return {\r\n        ...diff,\r\n        angle,\r\n        velocityX,\r\n        velocityY\r\n    }\r\n}\r\n\r\nexport function Tracker (): Tracker {\r\n    let logs: TraceLogs = []\r\n\r\n    function push (position: Position): void {\r\n        logs.push({\r\n            time: Date.now(),\r\n            ...position\r\n        })\r\n    }\r\n\r\n    function vector (): Vector {\r\n        return Vector(logs, logs.length - 1)\r\n    }\r\n\r\n    function clear () {\r\n        logs = []\r\n    }\r\n\r\n    function getLogs () {\r\n        return logs\r\n    }\r\n\r\n    function getDuration (): number {\r\n        const first = logs[0]\r\n        const last = logs[logs.length - 1]\r\n\r\n        return first ? last.time - first.time : 0\r\n    }\r\n\r\n    function getOffset (): Offset {\r\n        const first = logs[0]\r\n        const last = logs[logs.length - 1]\r\n\r\n        return first ? {\r\n            x: last.x - first.x,\r\n            y: last.y - first.y\r\n        } : {\r\n            x: 0,\r\n            y: 0\r\n        }\r\n    }\r\n\r\n    return {\r\n        getDuration,\r\n        getOffset,\r\n        getLogs,\r\n        vector,\r\n        clear,\r\n        push\r\n    }\r\n}\r\n","import { Tracker } from './trace'\r\n\r\nexport interface State {\r\n    tracker: Tracker\r\n    index: number\r\n    startTransform: number\r\n    isStart: boolean\r\n    isScrolling: boolean\r\n    isTouching: boolean\r\n    transforms: number\r\n    progress: number\r\n}\r\n\r\nexport function State (): State {\r\n    const state: State = {\r\n        tracker: Tracker(),\r\n        index: 0,\r\n        startTransform: 0,\r\n        isStart: false,\r\n        isScrolling: false,\r\n        isTouching: false,\r\n        transforms: 0,\r\n        progress: 0\r\n    }\r\n\r\n    return state\r\n}\r\n","function now () {\r\n    return performance ? performance.now() : Date.now()\r\n}\r\n\r\nexport type Tick = {\r\n    run (cb: (interval: DOMHighResTimeStamp) => void): void\r\n    stop (): void\r\n}\r\n\r\nexport function Tick (): Tick {\r\n    const nextFrame = requestAnimationFrame || webkitRequestAnimationFrame || setTimeout\r\n    const cancelNextFrame = cancelAnimationFrame || webkitCancelAnimationFrame || clearTimeout\r\n\r\n    let startTime: number | undefined\r\n    let id: number\r\n\r\n    function run (cb: (interval: DOMHighResTimeStamp) => void): void {\r\n        // eslint-disable-next-line no-void\r\n        startTime = startTime === void 0\r\n            ? now()\r\n            : startTime\r\n\r\n        // Why do not use callback argument:\r\n        // https://stackoverflow.com/questions/50895206/exact-time-of-display-requestanimationframe-usage-and-timeline\r\n        id = nextFrame(() => {\r\n            const timeStamp = now()\r\n            const interval = timeStamp - <number>startTime\r\n\r\n            startTime = timeStamp\r\n            cb(interval)\r\n        })\r\n    }\r\n\r\n    function stop (): void {\r\n        startTime = undefined\r\n        cancelNextFrame(id)\r\n    }\r\n\r\n    return {\r\n        run,\r\n        stop\r\n    }\r\n}\r\n","import { Tick } from './nextTick'\r\n\r\nexport type Animation = {\r\n    run (task: (interval: DOMHighResTimeStamp) => void): void\r\n    stop (): void\r\n}\r\n\r\nexport function Animation (): Animation {\r\n    const tick = Tick()\r\n\r\n    function run (task: (interval: DOMHighResTimeStamp) => void): void {\r\n        tick.run((interval: DOMHighResTimeStamp) => {\r\n            run(task)\r\n            task(interval)\r\n        })\r\n    }\r\n\r\n    function stop (): void {\r\n        tick.stop()\r\n    }\r\n\r\n    return {\r\n        run,\r\n        stop\r\n    }\r\n}\r\n","import { Position } from '../state/trace'\r\nimport { Options } from '../options'\r\nimport { Env } from '../env/index'\r\nimport { State } from '../state/index'\r\nimport { Operations } from '../state/operations'\r\nimport { Animation } from '../render/animation'\r\n\r\nexport type Actions = {\r\n    preheat (\r\n        originPosition: Position,\r\n        originTransform: number\r\n    ): void\r\n    move (position: Position): void\r\n    stop (): void\r\n}\r\n\r\nfunction resetState (\r\n    state: State,\r\n    operations: Operations\r\n): void {\r\n    const {\r\n        tracker\r\n    } = state\r\n    const {\r\n        initStatus\r\n    } = operations\r\n\r\n    tracker.clear()\r\n    initStatus()\r\n}\r\n\r\nexport function Actions (\r\n    options: Options,\r\n    env: Env,\r\n    state: State,\r\n    operations: Operations\r\n) {\r\n    const {\r\n        initLayout,\r\n        initStatus,\r\n        render,\r\n        scrollPixel,\r\n        slideTo,\r\n        getOffsetSteps\r\n    } = operations\r\n    const animation = Animation()\r\n\r\n    function preheat (\r\n        originPosition: Position,\r\n        originTransform: number\r\n    ): void {\r\n        const { tracker } = state\r\n\r\n        animation.stop()\r\n        tracker.clear()\r\n        tracker.push(originPosition)\r\n        initLayout(originTransform)\r\n        initStatus(originTransform)\r\n        state.isStart = true\r\n\r\n        render()\r\n    }\r\n\r\n    function move (position: Position): void {\r\n        const {\r\n            tracker\r\n        } = state\r\n        const {\r\n            touchRatio,\r\n            touchAngle,\r\n            isHorizontal\r\n        } = options\r\n\r\n        if (!state.isStart || state.isScrolling) return\r\n\r\n        tracker.push(position)\r\n\r\n        const vector = tracker.vector()\r\n        const displacement = tracker.getOffset()\r\n\r\n        // Ignore this move action if there is no displacement of screen touch point.\r\n        // In case of minimal mouse move event. (Moving mouse extreme slowly will get the zero offset.)\r\n        if (!displacement.x && !displacement.y) return\r\n\r\n        if ((isHorizontal && (vector.angle < touchAngle))\r\n            || (!isHorizontal && (90 - vector.angle) < touchAngle)\r\n            || state.isTouching\r\n        ) {\r\n            const offset = vector[isHorizontal ? 'x' : 'y'] * touchRatio\r\n\r\n            state.isTouching = true\r\n            scrollPixel(offset)\r\n            render()\r\n        } else {\r\n            state.isScrolling = true\r\n            tracker.clear()\r\n        }\r\n    }\r\n\r\n    function stop (): void {\r\n        const {\r\n            index,\r\n            tracker\r\n        } = state\r\n        const {\r\n            measure\r\n        } = env\r\n\r\n        if (!state.isStart) return\r\n\r\n        state.isStart = false\r\n\r\n        if (!options.freeMode) {\r\n            const duration = tracker.getDuration()\r\n            const trans = tracker.getOffset()[options.isHorizontal ? 'x' : 'y']\r\n            const jump = Math.ceil(Math.abs(trans) / measure.boxSize)\r\n            const longSwipeIndex = getOffsetSteps(trans)\r\n\r\n            if (duration > options.longSwipesMs) {\r\n                // long swipe action\r\n                slideTo(index + longSwipeIndex * (trans > 0 ? -1 : 1))\r\n            } else {\r\n                // short swipe action\r\n                slideTo(trans > 0 ? index - jump : index + jump)\r\n            }\r\n\r\n            resetState(state, operations)\r\n        } else {\r\n            const vector = tracker.vector()\r\n\r\n            let velocity = vector[options.isHorizontal ? 'velocityX' : 'velocityY']\r\n\r\n            animation.run((duration: number) => {\r\n                const offset = velocity * duration\r\n\r\n                velocity *= 0.98\r\n\r\n                if (Math.abs(offset) < 0.01) {\r\n                    animation.stop()\r\n                    resetState(state, operations)\r\n                } else {\r\n                    scrollPixel(offset)\r\n                    render(0)\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    return {\r\n        preheat,\r\n        move,\r\n        stop\r\n    }\r\n}\r\n","import { State } from '../state/index'\r\nimport { Env } from '../env/index'\r\nimport { attachListener, detachListener, getTranslate } from '../render/dom'\r\nimport { Options } from '../options'\r\nimport { Position } from '../state/trace'\r\nimport { Actions } from './actions'\r\nimport { Operations } from '../state/operations'\r\n\r\nexport type Sensor = {\r\n    attach: () => void\r\n    detach: () => void\r\n}\r\n\r\n// Only support single finger touch event.\r\nexport function Sensor (\r\n    env: Env,\r\n    state: State,\r\n    options: Options,\r\n    operations: Operations\r\n): Sensor {\r\n    const {\r\n        touchable\r\n    } = env\r\n    const formEls = [\r\n        'INPUT',\r\n        'SELECT',\r\n        'OPTION',\r\n        'TEXTAREA',\r\n        'BUTTON',\r\n        'VIDEO'\r\n    ]\r\n    const actions = Actions(options, env, state, operations)\r\n    const {\r\n        preheat,\r\n        move,\r\n        stop\r\n    } = actions\r\n\r\n    function getPosition (e: Event): Position {\r\n        const touch = touchable ? (<TouchEvent>e).changedTouches[0] : <MouseEvent>e\r\n\r\n        return {\r\n            x: touch.pageX,\r\n            y: touch.pageY\r\n        }\r\n    }\r\n\r\n    function onTouchStart (e: Event): void {\r\n        for (let i = 0; i < options.excludeElements.length; i++) {\r\n            if (options.excludeElements[i].contains(e.target as Node)) return\r\n        }\r\n\r\n        const {\r\n            $wrapper\r\n        } = env.element\r\n        const shouldPreventDefault = (options.touchStartPreventDefault && formEls.indexOf((<HTMLElement>e.target).nodeName) === -1)\r\n            || options.touchStartForcePreventDefault\r\n\r\n        if (shouldPreventDefault && !options.passiveListeners) e.preventDefault()\r\n\r\n        preheat(\r\n            getPosition(e),\r\n            getTranslate($wrapper, options.isHorizontal)\r\n        )\r\n    }\r\n\r\n    function onTouchMove (e: Event): void {\r\n        if (options.touchMoveStopPropagation) e.stopPropagation()\r\n\r\n        move(getPosition(e))\r\n        state.isTouching && e.preventDefault()\r\n    }\r\n\r\n    function onTouchEnd (): void {\r\n        stop()\r\n    }\r\n\r\n    function attach (): void {\r\n        const {\r\n            $el\r\n        } = env.element\r\n\r\n        if (touchable) {\r\n            attachListener($el, 'touchstart', onTouchStart, {\r\n                passive: options.passiveListeners,\r\n                capture: false\r\n            })\r\n            attachListener($el, 'touchmove', onTouchMove)\r\n            attachListener($el, 'touchend', onTouchEnd)\r\n            attachListener($el, 'touchcancel', onTouchEnd)\r\n        } else {\r\n            attachListener($el, 'mousedown', onTouchStart)\r\n            attachListener(document, 'mousemove', onTouchMove)\r\n            attachListener(document, 'mouseup', onTouchEnd)\r\n        }\r\n    }\r\n\r\n    function detach (): void {\r\n        const {\r\n            $el\r\n        } = env.element\r\n\r\n        detachListener($el, 'touchstart', onTouchStart)\r\n        detachListener($el, 'touchmove', onTouchMove)\r\n        detachListener($el, 'touchend', onTouchEnd)\r\n        detachListener($el, 'touchcancel', onTouchEnd)\r\n        detachListener($el, 'mousedown', onTouchStart)\r\n        detachListener(document, 'mousemove', onTouchMove)\r\n        detachListener(document, 'mouseup', onTouchEnd)\r\n    }\r\n\r\n    return {\r\n        attach,\r\n        detach\r\n    }\r\n}\r\n","import { Options } from '../options'\r\nimport { Element } from './element'\r\n\r\nexport type Measure = {\r\n    boxSize: number\r\n    viewSize: number\r\n    slideSize: number\r\n}\r\n\r\nexport function Measure (\r\n    options: Options,\r\n    element: Element\r\n): Measure {\r\n    const {\r\n        $el\r\n    } = element\r\n    const viewSize = options.isHorizontal ? $el.offsetWidth : $el.offsetHeight\r\n    const slideSize = (viewSize - (Math.ceil(options.slidesPerView - 1)) * options.spaceBetween) / options.slidesPerView\r\n    const boxSize = slideSize + options.spaceBetween\r\n\r\n    return {\r\n        boxSize,\r\n        viewSize,\r\n        slideSize\r\n    }\r\n}\r\n","import { Options } from '../options'\r\nimport { Element } from './element'\r\nimport { Measure } from './measure'\r\n\r\nexport type Limitation = {\r\n    min: number\r\n    max: number\r\n    base: number\r\n    expand: number\r\n    buffer: number\r\n    minIndex: number\r\n    maxIndex: number\r\n}\r\n\r\nexport function getExpand (\r\n    options: Options\r\n): number {\r\n    if (options.loop) {\r\n        // return options.slidesPerView >= element.$list.length\r\n        //     ? options.slidesPerView - element.$list.length + 1\r\n        //     : 1\r\n        return Math.ceil(options.slidesPerView)\r\n    }\r\n    return 0\r\n}\r\n\r\nexport function Limitation (\r\n    element: Element,\r\n    measure: Measure,\r\n    options: Options\r\n): Limitation {\r\n    const {\r\n        $list\r\n    } = element\r\n    const {\r\n        viewSize,\r\n        slideSize,\r\n        boxSize\r\n    } = measure\r\n    const expand = getExpand(options)\r\n    const buffer = expand * boxSize\r\n    const base = -buffer + (options.centeredSlides\r\n        ? (viewSize - slideSize) / 2\r\n        : 0)\r\n    // [min, max] usually equal to [-x, 0]\r\n    const max = base\r\n    const min = options.spaceBetween + (options.loop ? slideSize : viewSize) + base - boxSize * $list.length\r\n    const minIndex = 0\r\n    const maxIndex = $list.length - ((options.centeredSlides || options.loop)\r\n        ? 1\r\n        : Math.ceil(options.slidesPerView))\r\n\r\n    const limitation = {\r\n        max,\r\n        min,\r\n        base,\r\n        expand,\r\n        buffer,\r\n        minIndex,\r\n        maxIndex\r\n    }\r\n\r\n    return limitation\r\n}\r\n","import { Options } from '../options'\r\nimport { Element } from './element'\r\nimport { Measure } from './measure'\r\nimport { Limitation } from './limitation'\r\n\r\ndeclare global {\r\n    interface Window {\r\n        DocumentTouch: any\r\n    }\r\n    const DocumentTouch: any\r\n}\r\n\r\nexport type Env = {\r\n    touchable: boolean\r\n    element: Element\r\n    measure: Measure\r\n    limitation: Limitation\r\n    update (element: Element): void\r\n}\r\n\r\nexport function Env (\r\n    elem: Element,\r\n    options: Options\r\n): Env {\r\n    const env = <Env>{}\r\n\r\n    function update (element: Element): void {\r\n        const measure = Measure(\r\n            options,\r\n            element\r\n        )\r\n        const limitation = Limitation(\r\n            element,\r\n            measure,\r\n            options\r\n        )\r\n        const touchable = Boolean(\r\n            'ontouchstart' in window\r\n            || navigator.maxTouchPoints > 0\r\n            || navigator.msMaxTouchPoints > 0\r\n            || window.DocumentTouch && document instanceof DocumentTouch\r\n        )\r\n\r\n        Object.assign(env, {\r\n            touchable,\r\n            element,\r\n            measure,\r\n            limitation\r\n        })\r\n    }\r\n\r\n    env.update = update\r\n\r\n    update(elem)\r\n\r\n    return env\r\n}\r\n","import { Options } from '../options'\r\nimport {\r\n    removeClass, addClass, setStyle, setAttr, attachListener, detachListener\r\n} from './dom'\r\nimport { State } from '../state/index'\r\nimport { Env } from '../env/index'\r\n\r\nconst shallowTag = 'data-shallow-slider'\r\nconst sliderTag = 'data-slider'\r\n\r\nexport type Renderer = {\r\n    init (): void\r\n    render (\r\n        state: State,\r\n        duration?: number,\r\n        cb?: Function,\r\n        force?: boolean\r\n    ): void\r\n    destroy (): void\r\n    updateSize (): void\r\n}\r\n\r\nexport function Renderer (\r\n    env: Env,\r\n    options: Options\r\n): Renderer {\r\n    function updateItem (state: State): void {\r\n        const {\r\n            $wrapper\r\n        } = env.element\r\n        const {\r\n            index\r\n        } = state\r\n\r\n        $wrapper.querySelectorAll(`[${sliderTag}]`).forEach($slide => {\r\n            // eslint-disable-next-line no-bitwise\r\n            const tagNumber = ~~<string>$slide.getAttribute(sliderTag)\r\n\r\n            removeClass(<HTMLElement>$slide, [\r\n                options.slidePrevClass,\r\n                options.slideNextClass,\r\n                options.slideActiveClass\r\n            ])\r\n\r\n            if (tagNumber === index) {\r\n                addClass(<HTMLElement>$slide, options.slideActiveClass)\r\n            }\r\n            if (tagNumber === index - 1) {\r\n                addClass(<HTMLElement>$slide, options.slidePrevClass)\r\n            }\r\n            if (tagNumber === index + 1) {\r\n                addClass(<HTMLElement>$slide, options.slideNextClass)\r\n            }\r\n        })\r\n    }\r\n\r\n    function render (\r\n        state: State,\r\n        duration?: number,\r\n        cb?: Function,\r\n        force?: false\r\n    ) {\r\n        const {\r\n            $wrapper\r\n        } = env.element\r\n        const timing = duration === undefined ? options.speed : duration\r\n\r\n        options.injections.translate(state, env, options, timing)\r\n\r\n        // Update slide style only if scroll action is end.\r\n        if (!state.isStart) updateItem(state)\r\n\r\n        force && getComputedStyle($wrapper).transform\r\n        cb && setTimeout(cb, timing)\r\n    }\r\n\r\n    function appendExpandList (): void {\r\n        if (!options.loop) return\r\n\r\n        const {\r\n            element,\r\n            limitation\r\n        } = env\r\n        const {\r\n            $list,\r\n            $wrapper\r\n        } = element\r\n        const {\r\n            expand\r\n        } = limitation\r\n        const $leftExpandList = $list.slice(-expand)\r\n            .map($slide => <HTMLElement>$slide.cloneNode(true))\r\n        const $rightExpandList = $list.slice(0, expand)\r\n            .map($slide => <HTMLElement>$slide.cloneNode(true))\r\n\r\n        $leftExpandList.forEach(($shadowSlide, index) => {\r\n            $wrapper.appendChild(setAttr($rightExpandList[index], shallowTag))\r\n            $wrapper.insertBefore(setAttr($leftExpandList[index], shallowTag), $list[0])\r\n        })\r\n    }\r\n\r\n    function destroyExpandList (): void {\r\n        env.element.$wrapper\r\n            .querySelectorAll(`[${shallowTag}]`)\r\n            .forEach(item => env.element.$wrapper.removeChild(item))\r\n    }\r\n\r\n    function updateDom (): void {\r\n        env.element.$list.forEach((el, index) => setAttr(el, sliderTag, <any>index))\r\n\r\n        destroyExpandList()\r\n        appendExpandList()\r\n    }\r\n\r\n    function updateSize (): void {\r\n        const {\r\n            element,\r\n            measure\r\n        } = env\r\n        const {\r\n            $wrapper\r\n        } = element\r\n        const wrapperStyle = {\r\n            display: 'flex',\r\n            willChange: 'transform',\r\n            flexDirection: options.isHorizontal ? 'row' : 'column'\r\n        }\r\n        const itemStyle = {\r\n            [options.isHorizontal ? 'width' : 'height']: `${measure.slideSize}px`,\r\n            [options.isHorizontal ? 'margin-right' : 'margin-bottom']: `${options.spaceBetween}px`\r\n        }\r\n\r\n        setStyle($wrapper, wrapperStyle)\r\n        $wrapper.querySelectorAll(`[${sliderTag}]`)\r\n            .forEach($slide => setStyle(<HTMLElement>$slide, itemStyle))\r\n    }\r\n\r\n    function init (): void {\r\n        updateDom()\r\n        updateSize()\r\n    }\r\n\r\n    function destroy (): void {\r\n        const {\r\n            $list,\r\n            $wrapper\r\n        } = env.element\r\n        const arr = ['display', 'will-change', 'flex-direction']\r\n        const itemProp = options.isHorizontal ? 'margin-right' : 'margin-bottom'\r\n\r\n        arr.forEach((propertyName: string) => {\r\n            $wrapper.style.removeProperty(propertyName)\r\n        })\r\n        $list.forEach($slide => $slide.style.removeProperty(itemProp))\r\n        destroyExpandList()\r\n    }\r\n\r\n    return {\r\n        init,\r\n        render,\r\n        destroy,\r\n        updateSize\r\n    }\r\n}\r\n","import { State } from './index'\nimport { Limitation } from '../env/limitation'\nimport { EventHub, LIFE_CYCLES } from '../eventHub'\nimport { Renderer } from '../render/index'\nimport { Options } from '../options'\nimport { Env } from '../env/index'\n\nexport interface Operations {\n    update (): void\n    render (duration?: number): void\n    transform (trans: number): void\n    slideTo (\n        targetIndex: number,\n        duration?: number\n    ): void\n    scrollPixel (px: number): void\n    initStatus (startTransform?: number): void\n    initLayout (originTransform: number): void\n    getOffsetSteps (offset: number): number\n}\n\n/**\n * Detect whether slides is rush out boundary.\n * @param velocity - Velocity larger than zero means that slides move to the right direction\n * @param transform\n * @param limitation\n */\nexport function isExceedingLimits (\n    velocity: number,\n    transform: number,\n    limitation: Limitation\n): boolean {\n    return velocity > 0 && transform > (limitation.max)\n        || velocity < 0 && transform < (limitation.min)\n}\n\n/**\n * Return the shortest way to target Index.\n *      Negative number indicate the left direction, Index's value is decreasing.\n *      Positive number means index should increase.\n * @param currentIndex\n * @param targetIndex\n * @param limitation\n * @param defaultWay\n */\nexport function getShortestWay (\n    currentIndex: number,\n    targetIndex: number,\n    limitation: Limitation,\n    defaultWay: number\n): number {\n    const {\n        maxIndex,\n        minIndex\n    } = limitation\n\n    // Source expression show below:\n    // const shortcut = defaultWay > 0\n    //     ? minIndex - currentIndex + (targetIndex - maxIndex) - 1\n    //     : maxIndex - currentIndex + (targetIndex - minIndex) + 1\n\n    const shortcut = (defaultWay > 0 ? 1 : -1) * (minIndex - maxIndex - 1)\n        + targetIndex - currentIndex\n\n    return Math.abs(defaultWay) > Math.abs(shortcut)\n        ? shortcut\n        : defaultWay\n}\n\n/**\n * Get transform exceed value\n * Return zero if is not reached border.\n *\n * @param transform\n * @param limitation\n */\nexport function getExcess (\n    transform: number,\n    limitation: Limitation\n): number {\n    const exceedLeft = transform - limitation.max\n    const exceedRight = transform - limitation.min\n\n    return exceedLeft > 0\n        ? exceedLeft\n        : exceedRight < 0\n            ? exceedRight\n            : 0\n}\n\n/**\n * The Set of state operations.\n * Every external Render/Sensor/DomHandler are called by this Internal state machine.\n * That gives us the possibility to run Tiny-Swiper in different platform.\n *\n * @param env\n * @param state\n * @param options\n * @param renderer\n * @param eventHub\n * @constructor\n */\nexport function Operations (\n    env: Env,\n    state: State,\n    options: Options,\n    renderer: Renderer,\n    eventHub: EventHub\n): Operations {\n\n    /**\n     * Calculate the steps amount (boxSize) of offset.\n     *  eg: offset = 100, boxSize: 50, steps may equal to 2.\n     * @param offset\n     */\n    function getOffsetSteps (offset: number): number {\n        const {\n            measure\n        } = env\n        return Math.ceil(Math.abs(offset) / measure.boxSize - options.longSwipesRatio)\n    }\n\n    /**\n     * Call renderer's render function with default params.\n     * @param duration\n     * @param cb\n     * @param force\n     */\n    function render (\n        duration?: number,\n        cb?: Function,\n        force?: boolean\n    ): void {\n        renderer.render(\n            state,\n            duration,\n            cb,\n            force\n        )\n    }\n\n    /**\n     * Update Swiper transform attr.\n     * @param trans\n     */\n    function transform (trans: number): void {\n        const {\n            min,\n            max\n        } = env.limitation\n        const transRange = max - min + (options.loop ? env.measure.boxSize : 0)\n        const len = transRange + 1\n\n        let progress\n\n        state.transforms = trans\n\n        if (options.loop) {\n            progress = (max - trans) % len / transRange\n\n            state.progress = progress < 0\n                ? 1 + progress\n                : progress > 1\n                    ? progress - 1\n                    : progress\n        } else {\n            progress = (max - trans) / transRange\n\n            state.progress = progress < 0\n                ? 0\n                : progress > 1\n                    ? 1\n                    : progress\n        }\n\n        eventHub.emit(LIFE_CYCLES.SCROLL, {\n            ...state\n        })\n    }\n\n    /**\n     * Update Swiper transform state with certain Index.\n     * @param targetIndex\n     * @param duration\n     */\n    function slideTo (\n        targetIndex: number,\n        duration?: number\n    ): void {\n        const {\n            measure,\n            limitation\n        } = env\n        const len = limitation.maxIndex - limitation.minIndex + 1\n        const computedIndex = options.loop\n            ? (targetIndex % len + len) % len\n            : targetIndex > limitation.maxIndex\n                ? limitation.maxIndex\n                : targetIndex < limitation.minIndex\n                    ? limitation.minIndex\n                    : targetIndex\n        const newTransform = -computedIndex * measure.boxSize + limitation.base\n\n        // Slide to wrapper's boundary while touch end.\n        //  Math.abs(excess) ≥ 0\n        // Old condition: state.index === computedIndex\n        if (getOffsetSteps(newTransform - state.transforms) !== 0\n            && options.loop\n        ) {\n            const excess = getExcess(state.transforms, limitation)\n            const defaultWay = computedIndex - state.index\n            const shortcut = getShortestWay(\n                state.index,\n                computedIndex,\n                limitation,\n                defaultWay\n            )\n\n            if (shortcut !== defaultWay && !excess) {\n                transform(shortcut < 0\n                    ? limitation.min - measure.boxSize\n                    : limitation.max + measure.boxSize)\n            } else if (state.index === computedIndex) {\n                transform(excess > 0\n                    ? limitation.min - measure.boxSize + excess\n                    : limitation.max + measure.boxSize + excess)\n            }\n            // Set initial offset for rebounding animation.\n            render(0, undefined, true)\n        }\n\n        eventHub.emit(LIFE_CYCLES.BEFORE_SLIDE,\n            state.index,\n            state,\n            computedIndex)\n        state.index = computedIndex\n        transform(newTransform)\n        render(duration, () => {\n            eventHub.emit(LIFE_CYCLES.AFTER_SLIDE,\n                computedIndex,\n                state)\n        })\n    }\n\n    /**\n     * Scroll pixel by pixel while user dragging.\n     * @param px\n     */\n    function scrollPixel (px: number): void {\n        const {\n            transforms\n        } = state\n        const {\n            measure,\n            limitation\n        } = env\n        const ratio = Number(px.toExponential().split('e')[1])\n        const expand = ratio <= 0 ? Math.pow(10, -(ratio - 1)) : 1\n\n        let newTransform = transforms\n\n        // For optimizing, do not calculate `px` if options.loop === true\n        if (options.resistance && !options.loop) {\n            if (px > 0 && transforms >= limitation.max) {\n                px -= (px * expand) ** options.resistanceRatio / expand\n            } else if (px < 0 && transforms <= limitation.min) {\n                px += ((-px * expand) ** options.resistanceRatio) / expand\n            }\n        }\n\n        newTransform += px\n\n        if (options.loop) {\n            const vector = state.tracker.vector()\n            const velocity = options.isHorizontal ? vector.velocityX : vector.velocityY\n            const excess = getExcess(transforms, limitation)\n\n            if (excess && isExceedingLimits(\n                velocity,\n                transforms,\n                limitation\n            )) {\n                newTransform = excess > 0\n                    ? limitation.min - measure.boxSize + excess\n                    : limitation.max + measure.boxSize + excess\n            }\n        }\n\n        transform(newTransform)\n    }\n\n    function initStatus (startTransform = 0): void {\n        state.startTransform = startTransform\n        state.isStart = false\n        state.isScrolling = false\n        state.isTouching = false\n    }\n\n    function initLayout (originTransform: number): void {\n        transform(originTransform)\n    }\n\n    function update (): void {\n        slideTo(state.index, 0)\n        renderer.updateSize()\n    }\n\n    return {\n        update,\n        render,\n        transform,\n        slideTo,\n        scrollPixel,\n        initStatus,\n        initLayout,\n        getOffsetSteps\n    }\n}\n","import { Options } from '../options'\r\n\r\nexport type Element = {\r\n    $el: HTMLElement\r\n    $list: Array<HTMLElement>\r\n    $wrapper: HTMLElement\r\n}\r\n\r\nexport function Element (\r\n    el: HTMLElement | string,\r\n    options: Options\r\n): Element {\r\n    const $el = <HTMLElement>(typeof el === 'string' ? document.body.querySelector(el) : el)\r\n    const $wrapper = <HTMLElement>$el!.querySelector(`.${options.wrapperClass}`)\r\n    const $list = [].slice.call($el!.getElementsByClassName(options.slideClass))\r\n\r\n    return {\r\n        $el,\r\n        $wrapper,\r\n        $list\r\n    }\r\n}\r\n","import { UserOptions, optionFormatter, Options } from './options'\r\nimport { EventHub, LIFE_CYCLES } from './eventHub'\r\nimport { State } from './state/index'\r\nimport { Sensor } from './sensor/index'\r\nimport { Env } from './env/index'\r\nimport { Renderer } from './render/index'\r\nimport { Operations } from './state/operations'\r\nimport { Element } from './env/element'\r\n\r\nexport type SwiperInstance = {\r\n    on: (evtName: string, cb: Function) => void\r\n    off: (evtName: string, cb: Function) => void\r\n    update: () => void\r\n    destroy: () => void\r\n    slideTo: (index: number, duration?: number) => void\r\n    options: Options\r\n    env: Env\r\n    state: State\r\n    updateSize: () => void\r\n}\r\nexport type SwiperPlugin = (instance: SwiperInstance, options: Options) => void\r\n\r\nexport type Swiper = {\r\n    (el: HTMLElement | string, userOptions?: UserOptions): SwiperInstance\r\n    use: (plugins: Array<SwiperPlugin>) => void\r\n    plugins: Array<SwiperPlugin>\r\n}\r\n\r\nconst Swiper: Swiper = <Swiper> function (\r\n    el: HTMLElement | string,\r\n    userOptions: UserOptions\r\n): SwiperInstance {\r\n    const options = optionFormatter(userOptions)\r\n    const eventHub = EventHub()\r\n    const element = Element(\r\n        el,\r\n        options\r\n    )\r\n    const env = Env(element, options)\r\n    const state = State()\r\n    const {\r\n        on,\r\n        off,\r\n        emit\r\n    } = eventHub\r\n    const instance = {\r\n        on,\r\n        off,\r\n        env,\r\n        state,\r\n        options\r\n    } as SwiperInstance\r\n\r\n    (options.plugins || Swiper.plugins || [])\r\n        .forEach((plugin: SwiperPlugin) => plugin(\r\n            instance,\r\n            options\r\n        ))\r\n\r\n    emit(LIFE_CYCLES.BEFORE_INIT, instance)\r\n\r\n    // Initialize internal module\r\n    const renderer = Renderer(\r\n        env,\r\n        options\r\n    )\r\n    const operations = Operations(\r\n        env,\r\n        state,\r\n        options,\r\n        renderer,\r\n        eventHub\r\n    )\r\n    const sensor = Sensor(\r\n        env,\r\n        state,\r\n        options,\r\n        operations\r\n    )\r\n\r\n    function destroy (): void {\r\n        emit(LIFE_CYCLES.BEFORE_DESTROY, instance)\r\n        sensor.detach()\r\n        renderer.destroy()\r\n        emit(LIFE_CYCLES.AFTER_DESTROY, instance)\r\n        eventHub.clear()\r\n    }\r\n\r\n    function updateSize (): void {\r\n        env.update(Element(\r\n            el,\r\n            options\r\n        ))\r\n        operations.update()\r\n    }\r\n\r\n    function update (): void {\r\n        renderer.destroy()\r\n        env.update(Element(\r\n            el,\r\n            options\r\n        ))\r\n        renderer.init()\r\n        operations.update()\r\n    }\r\n\r\n    const {\r\n        slideTo\r\n    } = operations\r\n\r\n    Object.assign(instance, {\r\n        update,\r\n        destroy,\r\n        slideTo,\r\n        updateSize\r\n    })\r\n\r\n    renderer.init()\r\n    sensor.attach()\r\n    slideTo(\r\n        options.initialSlide,\r\n        0\r\n    )\r\n    emit(LIFE_CYCLES.AFTER_INIT, instance)\r\n\r\n    return instance\r\n}\r\n\r\nSwiper.use = (plugins: Array<SwiperPlugin>): void => {\r\n    Swiper.plugins = plugins\r\n}\r\n\r\nexport default Swiper\r\n"],"names":["addClass","el","list","Array","isArray","forEach","clz","classList","contains","add","removeClass","remove","attachListener","evtName","handler","opts","addEventListener","detachListener","removeEventListener","setAttr","attr","value","setAttribute","setStyle","style","forceRender","Object","keys","prop","getComputedStyle","getTranslate","isHorizontal","matrix","transform","replace","split","map","parseFloat","arr","length","slice","translate","state","env","options","duration","$wrapper","element","wrapperStyle","transition","isStart","transforms","defaultOptions","direction","touchRatio","touchAngle","longSwipesRatio","initialSlide","loop","freeMode","mousewheel","passiveListeners","resistance","resistanceRatio","speed","longSwipesMs","spaceBetween","slidesPerView","centeredSlides","slidePrevClass","slideNextClass","slideActiveClass","slideClass","wrapperClass","touchStartPreventDefault","touchStartForcePreventDefault","touchMoveStopPropagation","excludeElements","injections","optionFormatter","userOptions","LIFE_CYCLES","BEFORE_INIT","AFTER_INIT","BEFORE_SLIDE","SCROLL","AFTER_SLIDE","BEFORE_DESTROY","AFTER_DESTROY","EventHub","hub","on","cb","push","off","index","indexOf","splice","emit","data","clear","delta","Math","PI","Vector","logs","trace","formerTrace","diff","x","y","time","velocityX","velocityY","angle","atan2","abs","Tracker","position","Date","now","vector","getLogs","getDuration","first","last","getOffset","State","tracker","startTransform","isScrolling","isTouching","progress","performance","Tick","nextFrame","requestAnimationFrame","webkitRequestAnimationFrame","setTimeout","cancelNextFrame","cancelAnimationFrame","webkitCancelAnimationFrame","clearTimeout","startTime","id","run","timeStamp","interval","stop","undefined","Animation","tick","task","resetState","operations","initStatus","Actions","initLayout","render","scrollPixel","slideTo","getOffsetSteps","animation","preheat","originPosition","originTransform","move","displacement","offset","measure","trans","jump","ceil","boxSize","longSwipeIndex","velocity","Sensor","touchable","formEls","actions","getPosition","e","touch","changedTouches","pageX","pageY","onTouchStart","i","target","shouldPreventDefault","nodeName","preventDefault","onTouchMove","stopPropagation","onTouchEnd","attach","$el","passive","capture","document","detach","Measure","viewSize","offsetWidth","offsetHeight","slideSize","getExpand","Limitation","$list","expand","buffer","base","max","min","minIndex","maxIndex","limitation","Env","elem","update","Boolean","window","navigator","maxTouchPoints","msMaxTouchPoints","DocumentTouch","assign","shallowTag","sliderTag","Renderer","updateItem","querySelectorAll","$slide","tagNumber","getAttribute","force","timing","appendExpandList","$leftExpandList","cloneNode","$rightExpandList","$shadowSlide","appendChild","insertBefore","destroyExpandList","item","removeChild","updateDom","updateSize","display","willChange","flexDirection","itemStyle","init","destroy","itemProp","propertyName","removeProperty","isExceedingLimits","getShortestWay","currentIndex","targetIndex","defaultWay","shortcut","getExcess","exceedLeft","exceedRight","Operations","renderer","eventHub","transRange","len","computedIndex","newTransform","excess","px","ratio","Number","toExponential","pow","Element","body","querySelector","call","getElementsByClassName","Swiper","instance","plugins","plugin","sensor","use"],"mappings":"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"}